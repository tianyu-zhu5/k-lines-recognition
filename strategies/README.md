# 黑三鸦策略独立版本

本目录包含黑三鸦底部反转策略的独立实现，与通用回测框架隔离，避免后续修改影响已验证的策略配置。

## 📁 文件说明

### 1. 策略配置文件

**文件**：`black_crow_strategy_config.json`

**内容**：
- 策略基本信息（名称、版本、创建日期）
- 回测参数配置（资金、止损止盈、持仓天数等）
- 过滤器配置（RSI、累计跌幅、反转K线确认）
- 交易规则说明
- 历史绩效指标
- 优化建议和适用场景

**优势**：
- ✅ 参数配置与代码分离，便于管理和版本控制
- ✅ 可以创建多个配置文件测试不同参数组合
- ✅ 配置文件可以作为策略文档，记录参数演变历史

### 2. 独立回测脚本

**文件**：`../black_crow_strategy_backtest.py`

**功能**：
- 加载策略配置文件
- 执行黑三鸦策略回测
- 输出详细的回测结果
- 自动保存交易明细到CSV

**使用方法**：

```bash
# 在项目根目录执行
python black_crow_strategy_backtest.py
```

**输出示例**：

```
================================================================================
黑三鸦底部反转策略 - 独立回测
================================================================================

📋 加载策略配置...
策略名称: 黑三鸦底部反转策略
策略版本: v1.0
创建日期: 2025-10-02
回测区间: 2023-01-01 至 2025-09-19
股票池: hs300.txt

⚙️ 回测参数:
  初始资金: ¥300,000
  每次买入: ¥10,000
  止损比例: 7.0%
  止盈比例: 10.0%
  持仓天数: 10天
  回测形态: 黑三鸦

🔍 过滤器配置:
  累计跌幅过滤: ✗ 禁用
  RSI超卖过滤: ✓ 启用
    - RSI阈值: 30
    - RSI周期: 14天
  反转K线确认: ✓ 启用

📊 加载股票池...
成功加载 300 只股票

🚀 开始回测...
--------------------------------------------------------------------------------
[回测进度...]

================================================================================
📈 回测结果
================================================================================

总收益: ¥-6,214.69
总收益率: -2.07%
胜率: 46.6% (191/410)
最大回撤: 12.35%
夏普比率: -0.09

...

💾 回测结果已保存至: results/black_crow_backtest_20251002_143022.csv

================================================================================
回测完成！
================================================================================
```

## 🔧 修改策略参数

### 方法1：修改配置文件（推荐）

直接编辑 `black_crow_strategy_config.json`：

```json
{
  "backtest_config": {
    "stop_loss_pct": 0.05,     // 改为5%止损
    "stop_profit_pct": 0.08,   // 改为8%止盈
    "hold_days": 7             // 改为7天持仓
  },

  "filter_config": {
    "enable_drawdown_filter": true,  // 启用累计跌幅过滤
    "min_drawdown_pct": 0.20         // 改为20%回撤阈值
  }
}
```

### 方法2：创建新配置文件

复制 `black_crow_strategy_config.json` 为新文件：

```bash
cp black_crow_strategy_config.json black_crow_strategy_v2.json
```

修改 `black_crow_strategy_backtest.py` 加载新配置：

```python
strategy_config = load_strategy_config("strategies/black_crow_strategy_v2.json")
```

## 📊 与通用框架的关系

### 代码复用

独立版本仍然使用通用框架的核心模块：
- `patterns.py` - 形态识别
- `backtest.py` - 回测引擎
- `indicators.py` - 技术指标
- `data_loader.py` - 数据加载

### 隔离机制

**配置隔离**：
- 通用框架：前端UI动态配置
- 独立版本：JSON文件固定配置

**版本管理**：
- 通用框架可以继续优化和添加新功能
- 黑三鸦独立版本保持配置稳定
- 即使通用框架的默认参数改变，独立版本不受影响

**使用场景**：
- **通用框架**：用于测试新策略、调整参数、对比不同形态
- **独立版本**：用于稳定运行已验证的黑三鸦策略

## 📝 版本历史

### v1.0 (2025-10-02)

**初始版本**

**配置参数**：
- 止损：7%
- 止盈：10%
- 持仓：10天
- RSI过滤：启用（阈值30）
- 反转K线确认：启用
- 累计跌幅过滤：禁用

**回测结果**：
- 总收益率：-2.07%
- 胜率：46.6%
- 最大回撤：12.35%

**优化方向**：
- [ ] 测试累计跌幅过滤的效果
- [ ] 优化止盈止损比例
- [ ] 缩短持仓天数
- [ ] 引入市场环境过滤

## 🚀 未来计划

### 短期（1-2周）

- [ ] 测试累计跌幅过滤器（15%、20%阈值）
- [ ] 测试止盈止损组合（5%/8%、6%/9%等）
- [ ] 测试持仓天数（5天、7天、15天）

### 中期（1-2月）

- [ ] 实现动态止盈止损（基于ATR）
- [ ] 添加大盘趋势过滤
- [ ] 优化仓位管理（凯利公式）

### 长期（3-6月）

- [ ] 机器学习模型优化
- [ ] 多形态组合策略
- [ ] 行业轮动分析

## 📖 相关文档

- **技术分析报告**：`../docs/黑三鸦策略技术分析报告.md`
- **通用框架文档**：`../README.md`
- **回测结果**：`../results/`

## ⚠️ 重要提示

1. 本策略基于历史数据回测，实际效果可能与回测结果不同
2. 当前版本整体收益为负，建议优化后再实盘使用
3. 建议在模拟盘充分测试后再考虑实盘
4. 定期review策略表现，必要时调整参数

## 💡 使用建议

1. **参数优化**：使用配置文件系统测试不同参数组合
2. **版本管理**：为每次重要的参数调整创建新版本配置
3. **记录保存**：保存每次回测的结果CSV和配置JSON
4. **定期Review**：每月review策略表现，记录市场环境变化

---

**维护者**：策略开发团队
**最后更新**：2025-10-02
